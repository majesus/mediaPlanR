% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_MBBD.R
\encoding{UTF-8}
\name{calc_MBBD}
\alias{calc_MBBD}
\title{Cálculo del Modelo Morgensztem Beta Binomial Distribution (MBBD)}
\usage{
calc_MBBD(
  m,
  insertions,
  audiences,
  RM,
  universe,
  A0,
  precision = 100,
  max_iter = 100,
  adj_factor = 0.01
)
}
\arguments{
\item{m}{Integer. Número de soportes}

\item{insertions}{Vector numérico. Número de inserciones para cada soporte (ni)}

\item{audiences}{Vector numérico. Audiencia de cada soporte en personas (Ai)}

\item{RM}{Entero. Estimación de cobertura según Morgensztem en personas}

\item{universe}{Entero. Tamaño del universo objetivo en personas}

\item{A0}{Numérico. Valor inicial del parámetro A (entre 0 y 10)}

\item{precision}{Numérico. Criterio de convergencia en personas. Por defecto 100}

\item{max_iter}{Entero. Número máximo de iteraciones permitidas. Por defecto 100}

\item{adj_factor}{Numérico. Factor de ajuste para el parámetro A. Por defecto 0.01}
}
\value{
Una lista de clase "MBBD" conteniendo:
\itemize{
\item parameters: Lista con parámetros finales:
\itemize{
\item AF: Parámetro A final
\item BF: Parámetro B final
\item N: Total de inserciones
\item universe: Tamaño del universo
\item iterations: Número de iteraciones realizadas
\item converged: Indicador de convergencia
}
\item coverage: Lista con coberturas:
\itemize{
\item RM: Cobertura de Morgensztem
\item BBD: Cobertura Beta Binomial
}
\item contact_distribution: Vector con probabilidades de 0 a N contactos
\item iteration_history: Data frame con historial de iteraciones
}
}
\description{
Implementa el modelo MBBD para calcular la distribución de contactos
de un plan de medios. Combina la estimación de cobertura de Morgensztem con la
distribución beta binomial para ajustar la distribución de contactos.
}
\details{
El modelo MBBD ajusta iterativamente los parámetros de una distribución beta binomial
hasta que su cobertura coincide con la estimada por el método de Morgensztem:
\enumerate{
\item Calcula B0 inicial según la fórmula:
\itemize{
\item B0 = A0 * (SUMATORIO ni - SUMATORIO niAi) / (SUMATORIO niAi)
}
\item Ajusta iterativamente los parámetros hasta que las coberturas convergen:
\itemize{
\item Si RM mayor que BBD: aumenta A
\item Si RM menor que BBD: disminuye A
\item Recalcula B en cada iteración
}
}

El modelo asume:
\itemize{
\item Los parámetros A y B deben estar entre 0 y 10
\item La cobertura BBD se calcula como 1 - P(K=0)
\item La convergencia se alcanza cuando |BBD - RM| menor o igual que precision
}
}
\examples{
Ejemplo básico
m <- 3
insertions <- c(5, 7, 4)
audiences <- c(500000, 550000, 600000)
RM <- 550000
universe <- 1000000  # Añadimos el parámetro universe que faltaba
resultado <- calc_MBBD(m, insertions, audiences, RM, universe, A0=0.1)

# Examinar resultados
print(resultado)

}
\references{
Aldás Manzano, J. (1998). Modelos de determinación de la cobertura y la distribución de
contactos en la planificación de medios publicitarios impresos. Tesis doctoral, Universidad de Valencia, España.
}
\seealso{
\code{\link{calc_beta_binomial}} para estimaciones con la distribución Beta-Binomial
\code{\link{calc_sainsbury}} para estimaciones el modelo de Sainsbury
\code{\link{calc_binomial}} para estimaciones con el modelo Binomial
\code{\link{calc_metheringham}} para estimaciones con el modelo de Metheringham
}
