% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_modelos.R
\encoding{UTF-8}
\name{calc_beta_binomial}
\alias{calc_beta_binomial}
\title{Cálculo de la cobertura y distribución de contactos (y acumulada) usando modelo Beta-Binomial}
\usage{
calc_beta_binomial(A1, A2, P, n)
}
\arguments{
\item{A1}{Audiencia del soporte tras la primera inserción}

\item{A2}{Audiencia del soporte tras la segunda inserción}

\item{P}{Tamaño total de la población}

\item{n}{Número total de inserciones planificadas (debe ser entero positivo)}
}
\value{
Una lista "reach_beta_binomial" conteniendo:
\itemize{
\item reach: Lista con la cobertura:
\itemize{
\item porcentaje: Cobertura en porcentaje
\item personas: Cobertura en número de personas
}
\item distribucion: Lista con la distribución de contactos:
\itemize{
\item porcentaje: Vector con probabilidad de cada número de exposiciones
\item personas: Vector con número de personas para cada número de exposiciones
}
\item acumulada: Lista con la distribución acumulada:
\itemize{
\item porcentaje: Vector con probabilidades acumuladas
\item personas: Vector con número de personas acumuladas al menos i veces
}
\item parametros: Lista con parámetros del modelo:
\itemize{
\item alpha: Parámetro alpha estimado
\item beta: Parámetro beta estimado
\item prob_cero_contactos: Probabilidad de no exposición
}
}
}
\description{
Implementa el modelo Beta-Binomial para calcular la audiencia neta acumulada
y la distribución de contactos (y acumulada). El modelo Beta-Binomial considera la
heterogeneidad en la probabilidad de exposición de los individuos. Combina dos pasos:
\enumerate{
\item modela la probabilidad de éxito aplicando la distribución Beta de parámetros alpha y beta -lo cual reduce a dos
los datos necesarios para su estimación; 2) emplea la probabilidad en la distribución Binomial (combinada con la distribución Beta)
para valorar la distribución de contactos (y acumulada). Es útil cuando la probabilidad de
éxito no es conocida a priori, y puede variar entre los individuos. Los parámetros alpha y beta precisamente permiten
ajustar la forma de la distribución para que refleje la incertidumbre en relación con la probabilidad de éxito.
}
}
\details{
El modelo Beta-Binomial:
\enumerate{
\item Calcula los parámetros alpha y beta a partir de A1 y A2
\item Modela la heterogeneidad en la exposición mediante la distribución Beta
\item Combina la distribución Beta con la Binomial para la distribución de contactos
\item Calcula probabilidades exactas para cada nivel de exposición
}

El proceso incluye:
\itemize{
\item Estimación de coeficientes de duplicación R1 y R2
\item Cálculo de parámetros alpha y beta del modelo
\item Generación de distribución de contactos
\item Cálculo de la distribución de contactos (y acumuladas)
}
}
\note{
El modelo Beta-Binomial es especialmente adecuado cuando:
\itemize{
\item Existe heterogeneidad significativa en la población
\item Se dispone de datos de audiencias acumuladas (A1 y A2)
}
}
\examples{
# Ejemplo básico
resultado <- calc_beta_binomial(
  A1 = 500000,    # Primera audiencia
  A2 = 550000,    # Segunda audiencia
  P = 1000000,    # Población total
  n = 5           # Número de inserciones
)

# Examinar resultados
print(paste("Cobertura:", round(resultado$reach$porcentaje, 2), "\%"))
print(paste("Alpha:", round(resultado$parametros$alpha, 4)))
print(paste("Beta:", round(resultado$parametros$beta, 4)))

# Verificar consistencia de las distribuciones
\dontrun{
sum_dist <- sum(resultado$distribucion$porcentaje)/100
print(paste("Suma distribución:", round(sum_dist +
            resultado$parametros$prob_cero_contactos/100, 4)))
}

}
\references{
Aldás Manzano, J. (1998). Modelos de determinación de la cobertura y la distribución de
contactos en la planificación de medios publicitarios impresos. Tesis doctoral, Universidad de Valencia, España.
}
\seealso{
\code{\link{calc_sainsbury}} para estimaciones con el modelo de Sainsbury
\code{\link{calc_binomial}} para estimaciones con la distribución Binomial
\code{\link{calc_R1_R2}} para el cálculo de coeficientes de duplicación
}
