% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_modelos.R
\encoding{UTF-8}
\name{calc_metheringham}
\alias{calc_metheringham}
\title{Cálculo de métricas según el modelo de Metheringham}
\usage{
calc_metheringham(audiencias, inserciones, matriz_duplicacion)
}
\arguments{
\item{audiencias}{Vector numérico con las audiencias de cada soporte}

\item{inserciones}{Vector numérico con el número de inserciones por soporte}

\item{matriz_duplicacion}{Matriz simétrica con los valores de duplicación entre soportes}
}
\value{
Un objeto de clase 'reach_metheringham' conteniendo:
\itemize{
\item audiencia_media: Media ponderada de audiencias (A1)
\item duplicacion_media: Media ponderada de duplicaciones (D)
\item audiencia_segunda: Audiencia tras la segunda inserción (A2)
\item matriz_oportunidades: Matriz que contiene el número de oportunidades de contacto
entre pares de inserciones
\item vector_oportunidades: Versión linealizada de la matriz de oportunidades
\item vector_duplicacion: Versión linealizada de la matriz de duplicación
}
}
\description{
Calcula métricas fundamentales para la aplicación del modelo de Metheringham,
incluyendo la audiencia media (A1), duplicación media (D) y audiencia tras la segunda exposición en
el hipotético soporte promedio (A2). El modelo de Metheringham (1964) se basa en que
los individuos tienen probabilidades heterogéneas que se distribuyen como una distribución Beta para el conjunto.
Los soportes son homogéneos (a saber, todos los soportes acaban con la misma distribución Beta de probabilidades de exposición).
La acumulación y duplicación de audiencias se promedian entre los soportes para diseñar un soporte hipotético promedio.
}
\details{
La función realiza los siguientes cálculos principales:
\enumerate{
\item Audiencia media tras la primera inserción (A1):
\itemize{
\item Calcula la media ponderada de audiencias por número de inserciones
\item Fórmula: A1 = SUMATORIO(Audiencia_i × Inserciones_i) / SUMATORIO(Inserciones_i)
}
\item Duplicación media (D):
\itemize{
\item Calcula la media ponderada de duplicaciones por oportunidades de contacto
\item Considera todas las combinaciones posibles entre soportes ii, ij
}
\item Audiencia tras la segunda inserción (A2):
\itemize{
\item Calcula la audiencia que se expone al menos una vez tras la segunda inserción
\item Fórmula: A2 = 2 × A1 - D
}
}
}
\note{
La matriz de duplicación debe ser simétrica donde:
\itemize{
\item La diagonal contiene la duplicación de cada soporte consigo mismo
\item El elemento \link{i,j} contiene la duplicación entre los soportes i y j
\item Se debe cumplir que matriz\link{i,j} = matriz\link{j,i}
\item Para n soportes, la matriz debe ser de dimensiones n x n
}
}
\examples{
# Ejemplo básico con tres soportes
matriz_dup <- matrix(c(
  150000, 200000, 180000,
  200000, 120000, 140000,
  180000, 140000, 170000
), nrow = 3, byrow = TRUE)

metricas <- calc_metheringham(
  audiencias = c(1500000, 800000, 1200000),
  inserciones = c(4, 3, 5),
  matriz_duplicacion = matriz_dup
)

}
\references{
Aldás Manzano, J. (1998). Modelos de determinación de la cobertura y la distribución de
contactos en la planificación de medios publicitarios impresos. Tesis doctoral, Universidad de Valencia, España.
}
\seealso{
\code{\link{calc_sainsbury}} para estimaciones con la distribución Binomial
\code{\link{calc_binomial}} para estimaciones con la distribución Beta-Binomial
\code{\link{calc_beta_binomial}} para estimaciones con la distribución de Metheringham
\code{\link{calc_hofmans}} para estimaciones con la distribución de Hofmans
}
