% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_modelos.R
\encoding{UTF-8}
\name{calc_metheringham}
\alias{calc_metheringham}
\title{Cálculo de métricas según el modelo de Metheringham}
\usage{
calc_metheringham(audiencias, inserciones, vector_duplicacion, ayuda = TRUE)
}
\arguments{
\item{audiencias}{Vector numérico con las audiencias de cada soporte}

\item{inserciones}{Vector numérico con el número de inserciones por soporte}

\item{vector_duplicacion}{Vector numérico con valores de duplicación entre soportes}

\item{ayuda}{Lógico. Si TRUE, muestra una guía de uso detallada (default: TRUE)}
}
\value{
Una lista conteniendo:
\itemize{
\item audiencia_media: Media ponderada de audiencias (A1)
\item duplicacion_media: Media ponderada de duplicaciones (D)
\item audiencia_segunda: Audiencia tras la segunda inserción (A2)
\item matriz_oportunidades: Matriz de oportunidades de contacto
\item vector_oportunidades: Vector de oportunidades de contacto
}
}
\description{
Calcula métricas fundamentales para la aplicación del modelo de Metheringham,
incluyendo la audiencia media (A1), duplicación media (D) y audiencia tras la segunda exposición (A2)
del hipotético soporte medio. El modelo de Metheringham (1964) se basa en que
los individuos tienen probabilidades heterogéneas e independientes de exposición a los soportes,
siguiendo una distribución beta; esto convierte la exposición en un proceso de Bernoulli.
Además, asume que los soportes son homogéneos, por lo que usa la media de las audiencias para
modelar la exposición. La duplicación de audiencias no se considera aleatoria,
y al tratar los soportes como homogéneos, la acumulación de m inserciones se modela como
una distribución beta-binomial, simplificando el problema de duplicación entre soportes.
}
\details{
La función realiza los siguientes cálculos principales:
\enumerate{
\item Audiencia media tras la primera inserción (A1):
\itemize{
\item Calcula la media ponderada de audiencias por número de inserciones
\item Fórmula: A1 = SUMATORIO(Audiencia_i × Inserciones_i) / SUMATORIO(Inserciones_i)
}
\item Duplicación media (D):
\itemize{
\item Calcula la media ponderada de duplicaciones por oportunidades de contacto
\item Considera todas las combinaciones posibles entre soportes ii, ij
}
\item Audiencia tras la segunda inserción (A2):
\itemize{
\item Calcula la audiencia que se expone al menos una vez tras la segunda inserción
\item Fórmula: A2 = 2 × A1 - D
}
}
}
\note{
El vector de duplicación debe seguir un orden específico:
\itemize{
\item Para n soportes, se requieren n*(n+1)/2 valores
\item Los valores se ordenan por filas de la matriz triangular superior
\item Incluye la duplicación de cada soporte consigo mismo
\item El orden sigue el patrón: \link{1,1}, \link{1,2}, \link{1,3}, \link{2,2}, \link{2,3}, \link{3,3}
}
}
\examples{
# Ejemplo básico con tres soportes
metricas <- calc_metheringham(
  audiencias = c(1500000, 800000, 1200000),
  inserciones = c(4, 3, 5),
  vector_duplicacion = c(150000, 200000, 180000,
                        120000, 140000,
                        170000),
  ayuda = FALSE
)

# Mostrar solo la guía de uso
calc_metheringham(
  audiencias = NULL,
  inserciones = NULL,
  vector_duplicacion = NULL,
  ayuda = TRUE
)

}
\seealso{
\code{\link{calc_sainsbury}} para estimaciones con el modelo de Sainsbury
\code{\link{calc_binomial}} para estimaciones con el modelo Binomial
\code{\link{calc_beta_binomial}} para estimaciones con el modelo Beta-Binomial
}
